<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta content="target-densitydpi=device-dpi,width=640" name="viewport">
    <link rel="shortcut icon" type="image/x-icon" href="images/logo.ico" />
    <title>图扑</title>
    <meta name="author" content="图扑"/>
    <meta name="Copyright" content="图扑版权所有"/>
    <meta name="keywords" content="图扑，tupu，照片，话题，交友，美图，照片交友，话题交友，美图交友">
    <meta name="description" content="图扑，用照片创造话题。发布照片就可以发起话题，跟踪话题就可以发现世界。在这里，和好友、陌生人一起创造充满乐趣的生活图谱">

    <link rel="stylesheet" type="text/css" href="style/style.css" />
    <script type="text/javascript" src="js/util.js"></script>
</head>
<body>
<div class="wrapper clearfix">
    <div class="main">
        <img src="images/weixin.jpg" alt=""/>

    </div>
    <iframe frameborder="0" id="ifr" style="display: none;" src="javascript:void(0)"></iframe>
    <script type="text/javascript" src="js/jquery-1.9.0.min.js"></script>
    <script type="text/javascript">
        function localParam(search,hash){
            search = search || window.location.search;
            hash = hash || window.location.hash;
            var fn = function(str,reg){
                if(str){
                    var data = {};
                    str.replace(reg,function( $0, $1, $2, $3 ){
                        data[ $1 ] = $3;
                    });
                    return data;
                }
            }
            return {search: fn(search,new RegExp( "([^?=&]+)(=([^&]*))?", "g" ))||{},hash: fn(hash,new RegExp( "([^#=&]+)(=([^&]*))?", "g" ))||{}};
        }
        var nav = navigator,
                params = localParam(),
                isIDevice = (/iphone|ipod/gi).test(nav.platform),
                isIDeviceIpad = (/ipad/gi).test(nav.platform),
                isAndroid = (/Android/gi).test(nav.userAgent),
                isWeixin = (/MicroMessenger/ig).test(nav.userAgent),
                autoopen = params.search['autoopen']||params.hash['autoopen'],
                isappinstalled = params.search['isappinstalled'],
                appinstall = params.search['appinstall'],
                wxLink = 'http://reelin.github.io/tupu/weixin.html',
                iDownload = 'itms-apps://itunes.apple.com/us/app/tu-pu-yong-zhao-pian-chuang/id915233164?ls=1&amp;mt=8',
                openAppLink = 'newsapp://web/http://c.m.163.com/CreditMarket/default.html',
                iframe = document.getElementById('ifr');
        alert(isWeixin);
        alert(wxLink);
        if( (isIDevice || isIDeviceIpad) && !isAndroid){
            openAppLink = openAppLink || 'tupu://';
        }else if(isAndroid){
            openAppLink = 'http://tupu.im/';
        }
        if(isappinstalled!==undefined){
            wxLink += '?isappinstalled='+isappinstalled+'&openurl='+openAppLink;
        }else if(appinstall!==undefined){
            wxLink += '?appinstall='+appinstall+'&openurl='+openAppLink;
        }else{
            wxLink += '?openurl='+openAppLink;
        }
        alert(wxLink);
        function download(){
            if(isAndroid){
                window.location = 'http://tupu.im/';
            }else{
                window.location = iDownload;
            }
        }
        /*
         * iOS点击打开:
         1.如果是微信就去引导图页面
         2.如果不是微信就走安装就打开不安装就去app store
         3.如果微信用户按引导图从浏览器打开就能走通第2条

         android点击打开:
         1.如果是微信就在打开的时候同时跳转到有图的引导页
         2.如果不是微信就同时跳转到公公共下载页
         3.如果微信用户按引导图从浏览器打开就能走通第2条
         */
        function open(){
            if(isWeixin){
                alert(wxLink);
                window.location = wxLink;
            }else if((isIDevice || isIDeviceIpad) && !isAndroid){
                window.location = openAppLink;
                setTimeout(function(){
                    window.location = iDownload;
                }, 50);
            } else {
                iframe.src = openAppLink;
                download();
            }
        }
        $(".install-small").on("click",open);
        //自动打开
        if(autoopen==1){
            open();
        }
    </script>
</div>
</body>
</html>